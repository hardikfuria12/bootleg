<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Sales File Result</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body {
      padding: 2rem;
    }
    h2 {
      margin-top: 2rem;
    }
    .btn-download {
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <h1 class="mb-4">üìä Sales File Analysis</h1>

  <div>
    <h2>‚úÖ Clean Sales Data</h2>
    <div id="clean-table">{{ table_html_clean | safe }}</div>
    <button class="btn btn-success btn-download" onclick="downloadTableAsExcel('clean-table', 'clean_sales.xlsx')">
      ‚¨áÔ∏è Download Clean File
    </button>
  </div>

  {% if table_html_dirty %}
  <div>
    <h2 class="text-danger">‚ö†Ô∏è Dirty Sales Data</h2>
    <div id="dirty-table">{{ table_html_dirty | safe }}</div>
    <button class="btn btn-danger btn-download" onclick="downloadTableAsExcel('dirty-table', 'dirty_sales.xlsx')">
      ‚¨áÔ∏è Download Dirty File
    </button>
  </div>
  {% endif %}

  <script>
    function downloadTableAsExcel(tableId, filename) {
      const table = document.getElementById(tableId);
      const workbook = XLSX.utils.table_to_book(table, { sheet: "Sheet1" });
      XLSX.writeFile(workbook, filename);
    }
  </script>
</body>
</html>
